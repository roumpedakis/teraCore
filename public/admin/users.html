<!DOCTYPE html>
<html lang="el">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TeraCore Admin Users</title>  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap" rel="stylesheet" />
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" rel="stylesheet" />
  <link href="/admin/admin.css" rel="stylesheet" />
</head>
<body>
  <div class="admin-shell">
    <aside class="admin-sidebar">
      <div class="brand">
        <i class="fa-solid fa-shield-halved"></i>
        <span>TeraCore</span>
      </div>
      <nav class="nav-list">
        <a class="nav-link" href="/admin/dashboard"><i class="fa-solid fa-chart-line"></i> Dashboard</a>
        <a class="nav-link" href="/admin/users"><i class="fa-solid fa-users"></i> Users</a>
        <a class="nav-link" href="/admin/dashboard#admins"><i class="fa-solid fa-user-shield"></i> Admins</a>
        <a class="nav-link" href="/admin/dashboard#permissions"><i class="fa-solid fa-key"></i> Permissions</a>
        <button id="logout-button" class="btn btn-ghost mt-3">Logout</button>
      </nav>
    </aside>
    <main class="admin-content">
      <h1 class="page-title">Users</h1>
      <p class="subtitle">Διαχείριση χρηστών, tokens και πρόσβασης.</p>

      <section class="card fade-up">
        <div class="d-flex justify-content-between align-items-center mb-3">
          <div>
            <h2 class="mb-1"><i class="fa-solid fa-address-book"></i> User Directory</h2>
            <p class="subtitle">Επεξεργασία, revoke tokens, και δικαιώματα.</p>
          </div>
          <div class="d-flex gap-2">
            <div class="input-group" style="width: 250px;">
              <span class="input-group-text"><i class="fa-solid fa-search"></i></span>
              <input type="text" id="user-search" class="form-control" placeholder="Search users...">
            </div>
            <button class="btn btn-ghost"><i class="fa-solid fa-download"></i> Export</button>
            <button class="btn btn-primary" id="new-user-btn">
              <i class="fa-solid fa-user-plus"></i> New User
            </button>
          </div>
        </div>
        <div class="table-wrap">
          <table class="admin-table">
            <thead>
              <tr>
                <th><i class="fa-solid fa-user"></i> User</th>
                <th><i class="fa-solid fa-envelope"></i> Email</th>
                <th><i class="fa-solid fa-user-tag"></i> Role</th>
                <th><i class="fa-solid fa-circle-check"></i> Status</th>
                <th><i class="fa-solid fa-key"></i> Tokens</th>
                <th><i class="fa-solid fa-cog"></i> Actions</th>
              </tr>
            </thead>
            <tbody id="users-table-body">
              <tr><td colspan="6" class="text-center">Loading...</td></tr>
            </tbody>
          </table>
        </div>
      </section>

      <section class="card mt-4 fade-up stagger-1">
        <h2 class="mb-1"><i class="fa-solid fa-shield-halved"></i> Access Control</h2>
        <p class="subtitle">Ορίστε δικαιώματα πρόσβασης ανά υπηρεσία.</p>
        <div class="section-grid">
          <div class="metric">
            <h3><i class="fa-solid fa-newspaper"></i> Articles API</h3>
            <span><i class="fa-solid fa-pen-to-square"></i> Read/Write</span>
          </div>
          <div class="metric">
            <h3><i class="fa-solid fa-users"></i> Users API</h3>
            <span><i class="fa-solid fa-eye"></i> Read Only</span>
          </div>
          <div class="metric">
            <h3><i class="fa-solid fa-gear"></i> Admin Panel</h3>
            <span><i class="fa-solid fa-ban"></i> Restricted</span>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- User Modal -->
  <div class="modal fade" id="user-modal" tabindex="-1" aria-labelledby="user-modal-title" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="user-modal-title">New User</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="user-form">
            <input type="hidden" id="user-id">
            
            <div class="mb-3">
              <label for="user-username" class="form-label"><i class="fa-solid fa-user"></i> Username *</label>
              <input type="text" class="form-control" id="user-username" required>
            </div>
            
            <div class="mb-3">
              <label for="user-email" class="form-label"><i class="fa-solid fa-envelope"></i> Email *</label>
              <input type="email" class="form-control" id="user-email" required>
            </div>
            
            <div class="row">
              <div class="col-md-6 mb-3">
                <label for="user-first-name" class="form-label"><i class="fa-solid fa-id-card"></i> First Name</label>
                <input type="text" class="form-control" id="user-first-name">
              </div>
              <div class="col-md-6 mb-3">
                <label for="user-last-name" class="form-label"><i class="fa-solid fa-id-card-clip"></i> Last Name</label>
                <input type="text" class="form-control" id="user-last-name">
              </div>
            </div>
            
            <div class="mb-3">
              <label for="user-password" class="form-label"><i class="fa-solid fa-lock"></i> Password</label>
              <input type="password" class="form-control" id="user-password" required>
              <small class="text-muted"><i class="fa-solid fa-info-circle"></i> Leave empty to keep current password (edit mode)</small>
            </div>
            
            <div class="mb-3 form-check">
              <input type="checkbox" class="form-check-input" id="user-active">
              <label class="form-check-label" for="user-active"><i class="fa-solid fa-toggle-on"></i> Active</label>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost" data-bs-dismiss="modal"><i class="fa-solid fa-xmark"></i> Cancel</button>
          <button type="button" class="btn btn-primary" id="save-user-btn"><i class="fa-solid fa-save"></i> Save User</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Permissions Modal -->
  <div class="modal fade" id="permissions-modal" tabindex="-1" aria-labelledby="permissions-modal-title" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="permissions-modal-title"><i class="fa-solid fa-shield-halved"></i> User Permissions</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="permissions-user-id">
          <p class="text-muted"><i class="fa-solid fa-info-circle"></i> Select module access levels for <strong id="permissions-username"></strong></p>
          <div id="permissions-list">
            <div class="text-center"><i class="fa-solid fa-spinner fa-spin"></i> Loading modules...</div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost" data-bs-dismiss="modal"><i class="fa-solid fa-xmark"></i> Cancel</button>
          <button type="button" class="btn btn-primary" id="save-permissions-btn"><i class="fa-solid fa-save"></i> Save Permissions</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Password Reset Modal -->
  <div class="modal fade" id="password-modal" tabindex="-1" aria-labelledby="password-modal-title" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="password-modal-title"><i class="fa-solid fa-key"></i> Reset Password</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="password-user-id">
          <div class="mb-3">
            <label for="new-password" class="form-label"><i class="fa-solid fa-lock"></i> New Password</label>
            <input type="password" class="form-control" id="new-password" required>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost" data-bs-dismiss="modal"><i class="fa-solid fa-xmark"></i> Cancel</button>
          <button type="button" class="btn btn-primary" id="confirm-password-btn"><i class="fa-solid fa-check"></i> Reset</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Confirmation Modal -->
  <div class="modal fade" id="confirm-modal" tabindex="-1" aria-labelledby="confirm-modal-title" aria-hidden="true">
    <div class="modal-dialog modal-sm">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="confirm-modal-title"><i class="fa-solid fa-circle-question"></i> Confirm Action</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p id="confirm-message"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-ghost" data-bs-dismiss="modal"><i class="fa-solid fa-xmark"></i> Cancel</button>
          <button type="button" class="btn btn-danger" id="confirm-action-btn"><i class="fa-solid fa-check"></i> Confirm</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast Container -->
  <div class="position-fixed top-0 end-0 p-3" style="z-index: 9999">
    <div id="toast-container"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="/admin/users.js"></script>
</body>
</html>
